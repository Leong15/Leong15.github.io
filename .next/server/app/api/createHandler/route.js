(()=>{var e={};e.id=510,e.ids=[510],e.modules={5486:e=>{"use strict";e.exports=require("bcrypt")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},29021:e=>{"use strict";e.exports=require("fs")},33873:e=>{"use strict";e.exports=require("path")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},31421:e=>{"use strict";e.exports=require("node:child_process")},77598:e=>{"use strict";e.exports=require("node:crypto")},78474:e=>{"use strict";e.exports=require("node:events")},73024:e=>{"use strict";e.exports=require("node:fs")},51455:e=>{"use strict";e.exports=require("node:fs/promises")},48161:e=>{"use strict";e.exports=require("node:os")},76760:e=>{"use strict";e.exports=require("node:path")},1708:e=>{"use strict";e.exports=require("node:process")},7066:e=>{"use strict";e.exports=require("node:tty")},57975:e=>{"use strict";e.exports=require("node:util")},93912:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>L,routeModule:()=>E,serverHooks:()=>I,workAsyncStorage:()=>N,workUnitAsyncStorage:()=>T});var a={};t.r(a),t.d(a,{POST:()=>C});var s=t(42706),i=t(28203),n=t(45994),l=t(39187),u=t(57478),o=t(54697),c=t(32263),d=t(45473),m=t(95922),p=t(82571),f=t(22548),w=t(62010),A=t(72767),_=t(30082),g=t(35067),q=t(67291),S=t(89771),x=t(80996),v=t(26338),y=t(5486),h=t.n(y),b=t(55511);let R={Homepage:{db:o.A,raw_queries:'insert into cs_hp_revamp.sales_referral_user (staff_no,staff_name,ccc,unit,staff_img,manager,active) values ("{userid}","{fullname}","{ccc}","{unit}","{userid}.jpg",0,1); '},BEAR:{db:c.A,raw_queries:`insert into os_briefing.user(username,password,full_name,email,unit,ccc,privileges,rpp_setting,enable_email_alert,email_teams,creator,create_date,inactive) values 
        ("{userid}", md5("{userid}"), "{fullname}", "{email}", "{unit}", "{ccc}", "3","30","1","","admin",now(),"0") `},"Score Card":{db:g.A,raw_queries:`insert into score_card.user(login_id,pwd,username,email,ccc,tier,skill_id,acc_level_id,role,create_date,active) values 
            ("{userid}", md5("{userid}"), "{fullname}", "{email}", "{ccc}", "{tier}", "0","3","",now(),"1");`},KB:{db:w.A,raw_queries:`insert into knowledge_base.users(username,password,staffid,fullname,staffmail,team,ccc,contactno,acclevel,createdate,updatedate) values 
        ("{userid}", md5("{userid}"), "{userid}", "{fullname}", "{email}", "{unit}", "{ccc}", "{ext}", 3,now(),now());`},"E-Claim":{db:p.A,raw_queries:`insert into eclaim.users(username,password,staffno,lastname,middlename,englishname,initial,usr_fullname,team,subteam,ccc,ext,email,role,acclevel,createdate,createstaff,updatestaff,pwd_update,active,department) values 
            ("{userid}", md5("{userid}"), "{userid}", "{lastname}","{middlename}","{englishname}","{initial}",concat(lastname,", ",englishname," ",initial), "{unit}","","{ccc}", "{ext}", "{email}", "user",3,now(),"SYSTEM","SYSTEM",0,1,"CCS");`},"CSM Log":{db:m.A,raw_queries:'INSERT INTO csmlog.users(Userid,pwd,usrname,unit,email,acclevel,locked)VALUES("{userid}",md5("{userid}"),"{fullname}","{unit}","{email}","4","F");'},"Voice Portal":{db:S.A,raw_queries:`INSERT INTO compliement.users (username,password,acclevel,staffmail,staffname,team,ccc,staffno,updatedate,updater,active,sea)VALUES
            ("{userid}",md5("{userid}"),"2","{email}","{fullname}","{unit}","{ccc}","{userid}",now(),"1","T","1");`},SkyExchange:{db:q.A,raw_queries:`INSERT INTO sb_data_portal.user (staffID,staffName,staffPW,create_date,emailAddress,firstLogin,active,admin,role) VALUES
            ("{userid}", "{fullname}","{encrypt_pw}",now(),"{email}","1","1","0","ASM");`},"Cpc portal":{db:d.A,raw_queries:`INSERT INTO cpc_portal.users(username,staffname,password,role,title,email,create_date,update_date,active)VALUES
            ("{userid}","{fullname}",md5("{userid}"),"4","Account Service Officer","{email}",now(),now(),"1");`},"eform RPA Portal":{db:_.A,raw_queries:`INSERT INTO rpa_portal.users(username,staffname,password,role,title,email,create_date,update_date,active)VALUES
            ("{userid}","{fullname}",md5("{userid}"),"2","Customer Service Officer","{email}",now(),now(),"1");`},"CCS eLog Portal":{db:f.A,raw_queries:'INSERT INTO ccs_elog.user(login,pwd,staff_id,name,email)VALUES ("{userid}",md5("{userid}"),"{userid}","{fullname}","{email}");'},"Order SLA Portal":{db:A.A,raw_queries:`INSERT INTO order_sla.users(username,staffname,password,email,create_date,update_date,active)VALUES
            ("{userid}","{fullname}","{bcrypt_pw}","{email}",now(),now(),"1");`},"Duty Logging":{db:x.A,raw_queries:'INSERT INTO duty_logging.user(login,staff_id,name,team,email)VALUES("{userid}","{userid}","{fullname}","{unit}","{email}");'},"e-Order Request Portal":{db:v.A,raw_queries:`INSERT INTO cdr.user(login,pwd,staff_id,name,email,department,team,acclevel)VALUES
          ("{userid}","8e899755977993ba4d880632deb61acc","{userid}","{fullname}","{email}","{team}","{unit}","6");`},"eLearning Portal":{db:c.A,raw_queries:`INSERT INTO os_briefing.mooc_staff(staffID,staffPW,staffName,deptID,displayName,emailAddress,staffPhoto,phoneNo,locationID,admin,firstLogin,active,createDate)VALUES
          ("{userid}",md5("{encrypt_pw}"),"{fullname}","999","{fullname}","{email}","Default","28880000","1","0","1","1",now());`}};function P(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}async function C(e){try{let{userid:r,portalName:t}=await e.json(),a=await u.A.user.findMany({select:{userid:!0,lastname:!0,middlename:!0,initial:!0,englishname:!0,email:!0,unitRelation:{select:{unit:!0,ccc:!0,teamRelation:{select:{team:!0}}}},locationRelation:{select:{name:!0}},tierRelation:{select:{tier:!0}},ext:!0},where:{userid:r}});if(0==a.length)return l.NextResponse.json({error:"This Staff ID has No Sim account"},{status:404});let s=R[t];if(!s)return l.NextResponse.json({error:`The portal have not connect to DB or not connect set up not properly: ${t}`},{status:404});let i=s.raw_queries,n="";n=null!=a[0].englishname?P(a[0].englishname)+" "+P(a[0].lastname)+", "+a[0].initial:a[0].lastname+a[0].middlename;let o=function(e){let r=Buffer.from([73,118,97,110,32,77,101,100,118,101,100,101,118]),t=b.pbkdf2Sync("MAKV2SPBNI99212",r,1e3,48,"sha1"),a=t.subarray(0,32),s=t.subarray(32,48),i=Buffer.from(e,"utf16le"),n=b.createCipheriv("aes-256-cbc",a,s),l=n.update(i);return(l=Buffer.concat([l,n.final()])).toString("base64")}(r),c=await h().hash(r,10),d=i.replaceAll("{userid}",r).replaceAll("{fullname}",n).replaceAll("{email}",a[0].email).replaceAll("{unit}",a[0].unitRelation?.unit??"").replaceAll("{ccc}",a[0].unitRelation?.ccc??"").replaceAll("{ext}",a[0].ext).replaceAll("{initial}",a[0].initial).replaceAll("{location}",a[0].locationRelation?.name??"").replaceAll("{englishname}",a[0].englishname??"").replaceAll("{lastname}",a[0].lastname).replaceAll("{middlename}",a[0].middlename).replaceAll("{tier}",a[0].tierRelation?.tier??"").replaceAll("{team}",a[0].unitRelation?.teamRelation?.team??"").replaceAll("{encrypt_pw}",o).replaceAll("{bcrypt_pw}",c).replaceAll("\n","");return await s.db.$executeRawUnsafe(d),l.NextResponse.json(r+"'s "+t+" account has been created",{status:200})}catch(e){return l.NextResponse.json({error:`Sorry something happened! ${e.message}`},{status:500})}}let E=new s.AppRouteRouteModule({definition:{kind:i.RouteKind.APP_ROUTE,page:"/api/createHandler/route",pathname:"/api/createHandler",filename:"route",bundlePath:"app/api/createHandler/route"},resolvedPagePath:"Y:\\account_management\\src\\app\\api\\createHandler\\route.ts",nextConfigOutput:"",userland:a}),{workAsyncStorage:N,workUnitAsyncStorage:T,serverHooks:I}=E;function L(){return(0,n.patchFetch)({workAsyncStorage:N,workUnitAsyncStorage:T})}},96487:()=>{},78335:()=>{},32263:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(69639)).PrismaClient({log:["query","info","warn","error"],datasources:{db:{url:process.env.BEAR_DATABASE_URL}}})},26338:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(72395)).PrismaClient({log:["query","info","warn","error"]})},45473:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(77104)).PrismaClient({log:["query","info","warn","error"]})},95922:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(18912)).PrismaClient({log:["query","info","warn","error"]})},80996:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(33146)).PrismaClient({log:["query","info","warn","error"]})},22548:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(67980)).PrismaClient({log:["query","info","warn","error"],datasources:{db:{url:process.env.CCS_ELOG_DATABASE_URL}}})},82571:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(4539)).PrismaClient({log:["query","info","warn","error"]})},54697:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(36097)).PrismaClient({log:["query","info","warn","error"]})},62010:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(51820)).PrismaClient({log:["query","info","warn","error"]})},72767:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(66990)).PrismaClient({log:["query","info","warn","error"]})},30082:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(35599)).PrismaClient({log:["query","info","warn","error"]})},35067:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(81353)).PrismaClient({log:["query","info","warn","error"]})},57478:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(20870)).PrismaClient({log:["query","info","warn","error"]})},67291:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(11932)).PrismaClient({log:["query","info","warn","error"]})},89771:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=new(t(25702)).PrismaClient({log:["query","info","warn","error"]})}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[638,452,495,870],()=>t(93912));module.exports=a})();