(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4163],{53566:(e,s,r)=>{Promise.resolve().then(r.bind(r,46964))},46964:(e,s,r)=>{"use strict";r.d(s,{default:()=>G});var a=r(95155),n=r(12115),l=r(11451),o=r(46805),t=r(894),i=r(12488),d=r(72926),c=r(22282),u=r(71118),w=r(2615),h=r(4918),p=r(1396),x=r(41983),m=r(36017),j=r(2091),_=r(60391),g=r(2241),b=r(19579),f=r(48173),A=r.n(f),C=r(48987),P=r(62982),N=r(69606),v=r(85060),y=r(5404),S=r(78416),D=r(36417),k=r(9561),H=r(22678),I=r(75589),B=r(98987),U=r.n(B);let F=y.Ik({currentPassword:y.Yj().min(1,"Current password is required"),newPassword:y.Yj().min(1,"New password is required"),confirmNewPassword:y.Yj().min(1,"Confirm new password is required")}).refine(e=>e.currentPassword!==e.newPassword,{message:"New password cannot be the same as the current password",path:["newPassword"]}).refine(e=>e.newPassword===e.confirmNewPassword,{message:"Passwords do not match",path:["confirmNewPassword"]}),q=e=>{let{onClose:s,open:r}=e,{data:n}=(0,w.useSession)(),l=null==n?void 0:n.user.name,{control:o,handleSubmit:t,reset:d,formState:{errors:u}}=(0,N.mN)({resolver:(0,v.u)(F),defaultValues:{currentPassword:"",newPassword:"",confirmNewPassword:""}}),h=()=>{d(),s()},p=async e=>{let s={...e,username:l};try{let e=await fetch("/api/changePassword",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(e.ok){let s=await e.json();alert(s),h()}else{let s=await e.json();alert(s)}}catch(e){alert("Change Unsuccessful, Please try again later."),console.error("Error:",e)}};return(0,a.jsxs)(S.A,{onClose:h,open:r,component:"form",onSubmit:t(p),children:[(0,a.jsx)(D.A,{className:U().title,children:"Forget Password"}),(0,a.jsxs)(i.default,{className:U().container,children:[(0,a.jsx)(k.default,{className:U().currentpasswordlabel,variant:"body1",children:"Old Password:"}),(0,a.jsxs)(H.A,{className:U().currentpasswordinputfield,variant:"outlined",children:[(0,a.jsx)(N.xI,{name:"currentPassword",control:o,render:e=>{let{field:s}=e;return(0,a.jsx)(I.A,{value:s.value,onChange:s.onChange,placeholder:"Current Password"})}}),u.currentPassword&&(0,a.jsx)(i.default,{className:U().errorContainer,children:u.currentPassword.message})]}),(0,a.jsxs)(k.default,{className:U().newpasswordlabel,children:["New Password:"," "]}),(0,a.jsxs)(H.A,{className:U().newpasswordinputfield,variant:"outlined",children:[(0,a.jsx)(N.xI,{name:"newPassword",control:o,render:e=>{let{field:s}=e;return(0,a.jsx)(I.A,{value:s.value,onChange:s.onChange,placeholder:"New Password"})}}),u.newPassword&&(0,a.jsx)(i.default,{className:U().errorContainer,children:u.newPassword.message})]}),(0,a.jsxs)(k.default,{className:U().retypenewpasswordlabel,children:["Confirm ",(0,a.jsx)("br",{})," New Password:"," "]}),(0,a.jsxs)(H.A,{className:U().retypenewpasswordinputfield,variant:"outlined",children:[(0,a.jsx)(N.xI,{name:"confirmNewPassword",control:o,render:e=>{let{field:s}=e;return(0,a.jsx)(I.A,{value:s.value,onChange:s.onChange,placeholder:"Re-type New Password"})}}),u.confirmNewPassword&&(0,a.jsx)(i.default,{className:U().errorContainer,children:u.confirmNewPassword.message})]})]}),(0,a.jsx)(i.default,{className:U().resetBtnContainer,children:(0,a.jsx)(c.A,{type:"submit",className:U().resetBtn,children:(0,a.jsx)("b",{children:"Change"})})})]})};var O=r(80298),E=r.n(O);let M=()=>{let[e,s]=(0,n.useState)(!1);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.A,{id:"chagnebtn",size:"small",variant:"outlined",onClick:()=>{s(!0)},className:E().changeBtn,children:"Change Password"}),(0,a.jsx)(q,{open:e,onClose:()=>{s(!1)}})]})},Y=(e,s)=>(0,a.jsxs)(a.Fragment,{children:[(null==e?void 0:e.user.role)==="ADMIN"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.A,{subheader:(0,a.jsxs)(i.default,{className:E().listSubHeaderContainer,children:[(0,a.jsx)(p.A,{component:"div",id:"nested-list-subheader",className:E().listSubHeader,children:"Admin"}),(0,a.jsx)(M,{})]}),children:(0,a.jsx)(A(),{href:"/user_management",passHref:!0,style:{color:"black",textDecoration:"none"},children:(0,a.jsx)(x.Ay,{disablePadding:!0,children:(0,a.jsxs)(m.A,{onClick:()=>s(!1),children:[(0,a.jsx)(j.A,{children:(0,a.jsx)(C.A,{})}),(0,a.jsx)(_.A,{primary:"User Management"})]})},"UM")})}),(0,a.jsx)(A(),{href:"/action_history",passHref:!0,style:{color:"black",textDecoration:"none"},children:(0,a.jsx)(x.Ay,{disablePadding:!0,children:(0,a.jsxs)(m.A,{onClick:()=>s(!1),children:[(0,a.jsx)(j.A,{children:(0,a.jsx)(P.A,{})}),(0,a.jsx)(_.A,{primary:"User Action History"})]})},"Action_history")}),(0,a.jsx)(g.A,{})]}),(0,a.jsx)(h.A,{subheader:(0,a.jsxs)(i.default,{className:E().listSubHeaderContainer,children:[(0,a.jsx)(p.A,{component:"div",id:"nested-list-subheader",className:E().listSubHeader,children:"User"}),(null==e?void 0:e.user.role)!=="ADMIN"&&(0,a.jsx)(M,{})]}),children:(null==e?void 0:e.user.acc_level)!=3&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(A(),{href:"/staff_accounts_info",passHref:!0,style:{color:"black",textDecoration:"none"},children:(0,a.jsx)(x.Ay,{disablePadding:!0,children:(0,a.jsxs)(m.A,{onClick:()=>s(!1),children:[(0,a.jsx)(j.A,{children:(0,a.jsx)(C.A,{})}),(0,a.jsx)(_.A,{primary:"User Accounts Info"})]})},"SAI")})})})]}),T=e=>{let{open:s,toggleDrawer:r}=e,{data:n}=(0,w.useSession)();return(0,a.jsx)(b.Ay,{open:s,onClose:()=>r(!1),className:E().sidebar,children:Y(n,r)})};var W=r(73944),z=r.n(W);let G=()=>{let{data:e}=(0,w.useSession)(),[s,r]=n.useState(!1),h="Email: ".concat(null==e?void 0:e.user.email," \n          Role: ").concat(null==e?void 0:e.user.role,"\n          Access Level: ").concat(null==e?void 0:e.user.acc_level),p=e=>()=>{r(e)};return(0,a.jsx)(l.A,{className:z().appbar,children:(0,a.jsxs)(o.A,{className:z().toolbar,children:[(0,a.jsx)(t.A,{id:"sidebar",size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2},onClick:p(!0),children:(0,a.jsx)(u.A,{})}),(0,a.jsxs)(i.default,{className:z().infoContainer,children:[(0,a.jsx)(d.A,{title:h,slotProps:{tooltip:{sx:{whiteSpace:"pre-line"}}},children:(0,a.jsxs)("b",{className:z().userInfo,children:["Username: ",null==e?void 0:e.user.name]})}),(0,a.jsx)(c.A,{id:"slrBtn",variant:"contained",onClick:()=>{(0,w.signOut)({callbackUrl:"http://localhost:3000/login"})},children:"Logout"})]}),(0,a.jsx)(T,{open:s,toggleDrawer:p(!1)})]})})}},75589:(e,s,r)=>{"use strict";r.d(s,{A:()=>u});var a=r(95155),n=r(12115),l=r(12488),o=r(70152),t=r(11441),i=r(894),d=r(31798),c=r(9313);let u=e=>{let{value:s,onChange:r,placeholder:u}=e,[w,h]=(0,n.useState)(!1);return(0,a.jsx)(l.default,{mt:2,children:(0,a.jsx)(o.A,{className:"loginInputField",id:"password_input",label:u,value:s,onChange:r,placeholder:u,type:w?"text":"password",variant:"outlined",autoComplete:"current-password",slotProps:{input:{endAdornment:(0,a.jsx)(t.A,{position:"end",children:(0,a.jsx)(i.A,{"aria-label":"toggle password visibility",onClick:()=>h(e=>!e),edge:"end",children:w?(0,a.jsx)(d.A,{}):(0,a.jsx)(c.A,{})})})}}})})}},98987:e=>{e.exports={title:"ChangePasswordDialog_title__1q9WQ",container:"ChangePasswordDialog_container__CeXMa",currentpasswordlabel:"ChangePasswordDialog_currentpasswordlabel__oA8Ja",currentpasswordinputfield:"ChangePasswordDialog_currentpasswordinputfield__0AwKy",newpasswordlabel:"ChangePasswordDialog_newpasswordlabel__bUqqL",newpasswordinputfield:"ChangePasswordDialog_newpasswordinputfield__s3kzl",retypenewpasswordlabel:"ChangePasswordDialog_retypenewpasswordlabel__cjKgV",retypenewpasswordinputfield:"ChangePasswordDialog_retypenewpasswordinputfield__20Bfc",resetBtnContainer:"ChangePasswordDialog_resetBtnContainer__Wf1DR",resetBtn:"ChangePasswordDialog_resetBtn__Jbawd",errorContainer:"ChangePasswordDialog_errorContainer__eG0X6"}},73944:e=>{e.exports={appbar:"Navbar_appbar__ZHAne",toolbar:"Navbar_toolbar__CeTHD",userInfo:"Navbar_userInfo__G0veh"}},80298:e=>{e.exports={sidebar:"Sidebar_sidebar__DG0pi",listSubHeader:"Sidebar_listSubHeader__aYTuY",listSubHeaderContainer:"Sidebar_listSubHeaderContainer__W2NID",changeBtn:"Sidebar_changeBtn___WFg6"}}},e=>{var s=s=>e(e.s=s);e.O(0,[2060,41,595,947,3318,7420,2615,8173,3115,7942,8441,1517,7358],()=>s(53566)),_N_E=e.O()}]);